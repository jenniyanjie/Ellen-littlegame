<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Loading game…</title>
  <style>
    :root{--bg:#0e1116;--fg:#e6edf3}
    *{box-sizing:border-box} html,body{height:100%;margin:0}
    body{background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto}
    header{display:flex;gap:8px;align-items:center;padding:10px;position:sticky;top:0;background:#0e1116cc;backdrop-filter: blur(6px); z-index: 10}
    .btn{padding:8px 12px;border-radius:10px;border:1px solid #394457;background:#2a3443;color:var(--fg);text-decoration:none}
    #wrap{height:calc(100dvh - 56px)} iframe{width:100%;height:100%;border:0;display:block;background:#0f172a}
    .msg{padding:16px}
  </style>
</head>
<body>
  <header>
    <a class="btn" href="./">← Back</a>
    <button id="full" class="btn" type="button">Fullscreen</button>
    <span id="title" style="margin-left:8px;opacity:.8"></span>
  </header>
  <div id="wrap"><div class="msg">Loading…</div></div>

  <script>
    function getParam(name){ return new URLSearchParams(location.search).get(name) || ''; }
    const slug = (getParam('game') || '').toLowerCase();
    const safe = /^[a-z0-9-]+$/.test(slug) ? slug : '';
    const title = document.getElementById('title');
    const wrap  = document.getElementById('wrap');

    if(!safe){
      wrap.innerHTML = '<div class="msg">Missing or invalid game slug.</div>';
    }else{
      title.textContent = 'Now playing: ' + safe;
      const src = `./games/${safe}/`;
      const iframe = document.createElement('iframe');
      iframe.src = src;
      iframe.allowFullscreen = true;
      iframe.referrerPolicy = 'no-referrer';
      wrap.innerHTML = '';
      wrap.appendChild(iframe);

      iframe.addEventListener('error', () => {
        wrap.innerHTML = `<div class=\"msg\">Failed to load: <code>${src}</code>. Please make sure the directory and its index.html exist.</div>`;
      });
    }

    document.getElementById('full').onclick = () => {
      const el = document.querySelector('iframe');
      if (!el) return;
      if (document.fullscreenElement) document.exitFullscreen();
      else el.requestFullscreen?.();
    };
  </script>
</body>
</html>